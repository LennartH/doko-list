<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/lists"></ion-back-button>
    </ion-buttons>
    <ion-title>
      {{'listOfThe' | message }} {{ list?.startDate | date:'shortDate' }}
    </ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="onMenuClicked($event)">
        <ion-icon slot="icon-only" name="ellipsis-vertical"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>

  <ion-grid *ngIf="list" class="ion-no-padding">
    <ion-row class="title-row">
      <ion-col class="ion-text-end" size="1">
        <ion-text>#</ion-text>
      </ion-col>
      <ion-col *ngFor="let player of list.players" size="4">
        <ion-icon *ngIf="isDealer(player)" class="dealer-icon" src="assets/icon/dealer.svg"></ion-icon>
        <ion-text>{{ player }}</ion-text>
      </ion-col>
    </ion-row>
  </ion-grid>
</ion-header>

<!-- Hack to avoid multiple score calculations -->
<ng-container *ngIf="list?.scores as scores">
  <ion-content>
    <ion-grid id="main-grid" class="ion-no-padding">
      <ion-row *ngIf="scores.length === 0">
        <ion-col class="ion-padding-horizontal ion-text-center">
          <p class="ion-no-margin" class="no-rounds-message">{{ 'noRoundAdded' | message }}</p>
          <ion-button *ngIf="!list.isFinished" class="ion-padding-horizontal" expand="block" strong (click)="onAddRound()">
            {{ 'addRound' | message }}
          </ion-button>
        </ion-col>
      </ion-row>
      <ng-container *ngFor="let score of scores.slice(0, -1); let i = index; let isFirst = first">
        <ion-row *ngIf="isStartOfCycle(i) && !isFirst" class="separator-row"></ion-row>
        <app-round-row [roundNumber]="i" [list]="list" [points]="score"></app-round-row>
      </ng-container>
      <app-round-row *ngIf="!isGridOverflowing && scores.length > 0" [roundNumber]="scores.length - 1" [list]="list"
        [points]="scores[scores.length - 1]"></app-round-row>
    </ion-grid>

    <ion-fab *ngIf="!list.isFinished" vertical="bottom" horizontal="end" slot="fixed">
      <ion-fab-button (click)="onAddRound()">
        <ion-icon name="add"></ion-icon>
      </ion-fab-button>
    </ion-fab>
  </ion-content>

  <ion-footer *ngIf="isGridOverflowing && scores.length > 0">
    <ion-grid class="ion-no-padding">
      <app-round-row [roundNumber]="scores.length - 1" [list]="list" [points]="scores[scores.length - 1]"></app-round-row>
    </ion-grid>
  </ion-footer>
</ng-container>